From 1f796ca485bf70cf47d1c4a5f46dcdb42df17008 Mon Sep 17 00:00:00 2001
From: Pierre Gentile <pierre.gentile.perso@gmail.com>
Date: Tue, 2 Dec 2014 20:01:47 +0100
Subject: [PATCH] =?UTF-8?q?Setup=20corrig=C3=A9?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 setup.cfg |  9 ---------
 setup.py  | 26 +++++++-------------------
 2 files changed, 7 insertions(+), 28 deletions(-)
 delete mode 100644 setup.cfg
 mode change 100644 => 100755 setup.py

diff --git a/setup.cfg b/setup.cfg
deleted file mode 100644
index 731e63b..0000000
--- a/setup.cfg
+++ /dev/null
@@ -1,9 +0,0 @@
-[install]
-prefix = /opt/graphite
-install-lib = %(prefix)s/lib
-
-[bdist_rpm]
-requires = python-twisted
-           whisper
-
-post-install = distro/redhat/misc/postinstall
diff --git a/setup.py b/setup.py
old mode 100644
new mode 100755
index 1f1f4ff..ef86a02
--- a/setup.py
+++ b/setup.py
@@ -4,29 +4,14 @@ import os
 import platform
 from glob import glob
 
-if os.environ.get('USE_SETUPTOOLS'):
+try:
   from setuptools import setup
   setup_kwargs = dict(zip_safe=0)
-
-else:
+except ImportError:
   from distutils.core import setup
   setup_kwargs = dict()
 
 
-storage_dirs = [ ('storage/whisper',[]), ('storage/lists',[]),
-                 ('storage/log',[]), ('storage/rrd',[]) ]
-conf_files = [ ('conf', glob('conf/*.example')) ]
-
-install_files = storage_dirs + conf_files
-
-# If we are building on RedHat, let's use the redhat init scripts.
-if platform.dist()[0] == 'redhat':
-    init_scripts = [ ('/etc/init.d', ['distro/redhat/init.d/carbon-cache',
-                                      'distro/redhat/init.d/carbon-relay',
-                                      'distro/redhat/init.d/carbon-aggregator']) ]
-    install_files += init_scripts
-
-
 setup(
   name='carbon',
   version='0.9.12',
@@ -39,7 +24,10 @@ setup(
   package_dir={'' : 'lib'},
   scripts=glob('bin/*'),
   package_data={ 'carbon' : ['*.xml'] },
-  data_files=install_files,
-  install_requires=['twisted', 'txamqp'],
+  install_requires=[
+    'Twisted==11.1.0',
+    'txamqp',
+    'whisper==0.9.12',
+  ],
   **setup_kwargs
 )
-- 
2.2.0

